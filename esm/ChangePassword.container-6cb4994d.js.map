{"version":3,"file":"ChangePassword.container-6cb4994d.js","sources":["../src/routing/util/find-contenttype-mapping.ts","../src/user/transformations/mapClientCredentials.js","../src/user/util/ContensisManagementApi.js","../src/user/util/OidcUserManager.ts","../src/user/util/LoginHelper.class.js","../src/user/redux/sagas/login.js","../src/user/redux/actions.js","../src/user/hooks/useLogin.js","../src/user/containers/Login.container.js","../src/user/hooks/useRegistration.js","../src/user/containers/Registration.container.js","../src/user/hooks/useForgotPassword.js","../src/user/containers/ForgotPassword.container.js","../src/user/hooks/useChangePassword.js","../src/user/containers/ChangePassword.container.js"],"sourcesContent":["import { ContentTypeMapping } from '../routes';\r\n\r\nexport const findContentTypeMapping = (\r\n  ContentTypeMappings: ContentTypeMapping[],\r\n  contentTypeId: string\r\n) => ContentTypeMappings.find(ct => ct.contentTypeID === contentTypeId);\r\n","import { mapJson } from '~/util/json-mapper';\r\n\r\nconst clientCredentials = {\r\n  bearerToken: 'bearerToken',\r\n  bearerTokenExpiryDate: ({ bearerTokenExpiryDate }) =>\r\n    bearerTokenExpiryDate.toISOString(),\r\n  refreshToken: 'refreshToken',\r\n  refreshTokenExpiryDate: ({ refreshTokenExpiryDate }) =>\r\n    refreshTokenExpiryDate.toISOString(),\r\n  contensisClassicToken: 'contensisClassicToken',\r\n};\r\nexport default obj => mapJson(obj, clientCredentials);\r\n","// import { Client } from 'contensis-management-api';\r\n\r\nexport const getManagementApiClient = async ({\r\n  bearerToken,\r\n  bearerTokenExpiryDate,\r\n  refreshToken,\r\n  refreshTokenExpiryDate,\r\n  contensisClassicToken,\r\n  username,\r\n  password,\r\n}) => {\r\n  const rootUrl = SERVERS.api || SERVERS.cms; /* global SERVERS */\r\n  const projectId = PROJECTS[0].id; /* global PROJECTS */\r\n\r\n  let config = {};\r\n  if (refreshToken) {\r\n    config = {\r\n      clientType: 'contensis_classic_refresh_token',\r\n      clientDetails: {\r\n        refreshToken,\r\n      },\r\n    };\r\n  } else {\r\n    config = {\r\n      clientType: 'contensis_classic',\r\n      clientDetails: {\r\n        username,\r\n        password,\r\n      },\r\n    };\r\n  }\r\n\r\n  let { Client } = await import('contensis-management-api');\r\n\r\n  if (typeof window === 'undefined') {\r\n    const { UniversalClient } = await import('contensis-management-api');\r\n    Client = UniversalClient;\r\n  }\r\n\r\n  const client = Client.create({\r\n    ...config,\r\n    projectId,\r\n    rootUrl,\r\n  });\r\n\r\n  if (bearerToken) client.bearerToken = bearerToken;\r\n  if (bearerTokenExpiryDate)\r\n    client.bearerTokenExpiryDate = bearerTokenExpiryDate;\r\n  if (refreshToken) client.refreshToken = refreshToken;\r\n  if (refreshTokenExpiryDate)\r\n    client.refreshTokenExpiryDate = refreshTokenExpiryDate;\r\n  if (contensisClassicToken)\r\n    client.contensisClassicToken = contensisClassicToken;\r\n\r\n  return client;\r\n};\r\n","import { UserManagerSettings } from 'oidc-client';\r\n\r\nconst context = (\r\n  typeof window != 'undefined' ? window : global\r\n) as typeof globalThis & {\r\n  WSFED_LOGIN: string;\r\n};\r\n\r\nconst requireOidc =\r\n  process.env.NODE_ENV === 'development'\r\n    ? WSFED_LOGIN === 'true' /* global WSFED_LOGIN */\r\n    : context.WSFED_LOGIN === 'true';\r\n\r\nconst servers = SERVERS; /* global SERVERS */\r\n\r\nexport const userManagerConfig =\r\n  typeof window !== 'undefined'\r\n    ? {\r\n        authority: `${servers.cms}/authenticate/`,\r\n        client_id: 'WebsiteAdfsClient',\r\n        redirect_uri: window.location.toString(),\r\n        post_logout_redirect_uri: window.location.toString(),\r\n        response_type: 'id_token',\r\n        scope: 'openid',\r\n        filterProtocolClaims: false,\r\n      }\r\n    : {};\r\n\r\nexport const createUserManager = async (config: UserManagerSettings) => {\r\n  if (typeof window !== 'undefined' && requireOidc) {\r\n    try {\r\n      const { UserManager } = await import(\r\n        /* webpackChunkName: \"oidcclient\" */ 'oidc-client'\r\n      );\r\n      return new UserManager(config);\r\n    } catch (e) {\r\n      console.error('Exception in createUserManager: ', e);\r\n    }\r\n  } else return {};\r\n};\r\n","/* eslint-disable require-atomic-updates */\r\nimport { to } from 'await-to-js';\r\n\r\nimport { getManagementApiClient } from './ContensisManagementApi';\r\n\r\nimport mapClientCredentials from '../transformations/mapClientCredentials';\r\nimport { createUserManager, userManagerConfig } from './OidcUserManager';\r\nimport { LOGIN_COOKIE, REFRESH_TOKEN_COOKIE } from './CookieConstants';\r\n\r\nconst context = typeof window != 'undefined' ? window : global;\r\n\r\nexport class LoginHelper {\r\n  static CMS_URL = SERVERS.cms /* global SERVERS */;\r\n  static WSFED_LOGIN =\r\n    process.env.NODE_ENV === 'development'\r\n      ? WSFED_LOGIN === 'true' /* global WSFED_LOGIN */\r\n      : context.WSFED_LOGIN === 'true';\r\n  static LOGIN_ROUTE = '/account/login';\r\n  static ACCESS_DENIED_ROUTE = '/account/access-denied';\r\n\r\n  cookies;\r\n  constructor(cookies) {\r\n    this.cookies = cookies;\r\n  }\r\n\r\n  SetLoginCookies({ contensisClassicToken, refreshToken }) {\r\n    console.info(\r\n      'SetLoginCookies:',\r\n      LOGIN_COOKIE,\r\n      contensisClassicToken,\r\n      REFRESH_TOKEN_COOKIE,\r\n      refreshToken\r\n    );\r\n\r\n    if (contensisClassicToken)\r\n      this.cookies.SetCookie(LOGIN_COOKIE, contensisClassicToken);\r\n\r\n    if (refreshToken)\r\n      this.cookies.SetCookie(REFRESH_TOKEN_COOKIE, refreshToken);\r\n  }\r\n\r\n  GetCachedCredentials() {\r\n    return {\r\n      bearerToken: null,\r\n      bearerTokenExpiryDate: null,\r\n      refreshToken: this.cookies.GetCookie(REFRESH_TOKEN_COOKIE),\r\n      refreshTokenExpiryDate: null,\r\n      contensisClassicToken: this.cookies.GetCookie(LOGIN_COOKIE),\r\n    };\r\n  }\r\n\r\n  ClearCachedCredentials() {\r\n    this.cookies.DeleteCookie(LOGIN_COOKIE);\r\n    this.cookies.DeleteCookie(REFRESH_TOKEN_COOKIE);\r\n\r\n    if (LoginHelper.WSFED_LOGIN && typeof window !== 'undefined') {\r\n      // remove any oidc keys left over in localStorage\r\n      const { localStorage } = window;\r\n      const keys = [];\r\n      for (let i = 0; i < localStorage.length; i++) {\r\n        const key = localStorage.key(i);\r\n        if (typeof key === 'string' && key.startsWith('oidc.'))\r\n          keys.push(localStorage.key(i));\r\n      }\r\n      keys.forEach(key => localStorage.removeItem(key));\r\n    }\r\n  }\r\n\r\n  async LoginUser({ username, password, clientCredentials }) {\r\n    let credentials = clientCredentials;\r\n    let authenticationState = {\r\n      clientCredentials: null,\r\n      isAuthenticated: false,\r\n      isAuthenticationError: false,\r\n      isError: false,\r\n    };\r\n    let transientClient;\r\n    let user;\r\n\r\n    if (username && password) {\r\n      // Get a management client with username and password\r\n      transientClient = await getManagementApiClient({\r\n        username,\r\n        password,\r\n      });\r\n\r\n      // Ensure the client has requested a bearer token\r\n      const [loginError, clientBearerToken] = await to(\r\n        transientClient.ensureBearerToken()\r\n      );\r\n\r\n      // Problem getting token with username and password\r\n      if (loginError) {\r\n        authenticationState = {\r\n          clientCredentials: null,\r\n          errorMessage: loginError.message || null,\r\n          isAuthenticated: false,\r\n          isAuthenticationError: loginError.name.includes(\r\n            'ContensisAuthenticationError'\r\n          ),\r\n          isError: true,\r\n        };\r\n        this.ClearCachedCredentials();\r\n      }\r\n\r\n      // Got a token using username and password\r\n      if (clientBearerToken) {\r\n        // Set credentials so we can continue to GetUserDetails\r\n        credentials = mapClientCredentials(transientClient);\r\n        this.SetLoginCookies(credentials);\r\n        authenticationState = {\r\n          clientCredentials: credentials,\r\n          isAuthenticated: true,\r\n          isAuthenticationError: false,\r\n          isError: false,\r\n        };\r\n      }\r\n    }\r\n\r\n    // If we have credentials supplied by a successful username and password login\r\n    // or clientCredentials supplied in the options argument we can continue to\r\n    // fetch the user's details\r\n    if (credentials) {\r\n      const client =\r\n        transientClient || (await getManagementApiClient(credentials));\r\n      const [error, userDetails] = await LoginHelper.GetUserDetails(client);\r\n\r\n      if (error) {\r\n        authenticationState = {\r\n          clientCredentials: null,\r\n          errorMessage: error.message,\r\n          isAuthenticated: false,\r\n          isAuthenticationError: false,\r\n          isError: true,\r\n        };\r\n        this.ClearCachedCredentials();\r\n      } else {\r\n        // Ensure we get latest refreshToken and contensisClassicToken from the latest client\r\n        const latestCredentials = mapClientCredentials(client);\r\n        this.SetLoginCookies(latestCredentials);\r\n\r\n        user = userDetails;\r\n        authenticationState = {\r\n          clientCredentials: latestCredentials,\r\n          isAuthenticated: true,\r\n          isAuthenticationError: false,\r\n          isError: false,\r\n        };\r\n      }\r\n    }\r\n\r\n    return { authenticationState, user };\r\n  }\r\n\r\n  LogoutUser(redirectPath) {\r\n    this.ClearCachedCredentials();\r\n    if (LoginHelper.WSFED_LOGIN) {\r\n      LoginHelper.WsFedLogout(redirectPath);\r\n    } else {\r\n      if (redirectPath) LoginHelper.ClientRedirectToPath(redirectPath);\r\n      else LoginHelper.ClientRedirectToSignInPage();\r\n    }\r\n  }\r\n\r\n  static withCookies = cookieHelper => new LoginHelper(cookieHelper);\r\n\r\n  static GetUserDetails = async client => {\r\n    let userError,\r\n      groupsError,\r\n      user = {},\r\n      groupsResult;\r\n\r\n    [userError, user] = await to(client.security.users.getCurrent());\r\n    if (user && user.id) {\r\n      [groupsError, groupsResult] = await to(\r\n        client.security.users.getUserGroups({\r\n          userId: user.id,\r\n          includeInherited: true,\r\n          pageOptions: { pageSize: 100 },\r\n        })\r\n      );\r\n      // Set groups attribute in user object to be the items\r\n      // array from the getUserGroups result\r\n      if (groupsResult && groupsResult.items) user.groups = groupsResult.items;\r\n\r\n      //If groups call fails then log the error but allow the user to login still\r\n      // eslint-disable-next-line no-console\r\n      if (groupsError) console.log(groupsError);\r\n    }\r\n    return [userError, user];\r\n  };\r\n\r\n  static ClientRedirectToHome(location) {\r\n    if (typeof window != 'undefined') {\r\n      let url = '/';\r\n      if (location) {\r\n        const { search, hash } = location;\r\n        url = search ? `${url}${search}` : url;\r\n        url = hash ? `${url}${hash}` : url;\r\n      }\r\n      window.location.href = url;\r\n    }\r\n  }\r\n\r\n  static async ClientRedirectToSignInPage(redirectPath) {\r\n    if (typeof location === 'undefined') return;\r\n    if (LoginHelper.WSFED_LOGIN) {\r\n      await LoginHelper.WsFedLogout();\r\n      await LoginHelper.WsFedLogin();\r\n    } else {\r\n      // Standard Contensis Login\r\n      let url = LoginHelper.LOGIN_ROUTE;\r\n      if (typeof redirectPath === 'string')\r\n        url = `${url}?redirect_uri=${redirectPath}`;\r\n      if (\r\n        typeof location !== 'undefined' &&\r\n        redirectPath !== LoginHelper.LOGIN_ROUTE\r\n      )\r\n        location.replace(url);\r\n    }\r\n  }\r\n\r\n  static GetAccessDeniedRoute(originalPath) {\r\n    let url = LoginHelper.ACCESS_DENIED_ROUTE;\r\n    if (originalPath !== url && typeof originalPath === 'string')\r\n      url = `${url}?original_uri=${originalPath}`;\r\n    return url;\r\n  }\r\n\r\n  static ClientRedirectToAccessDeniedPage(originalPath) {\r\n    if (typeof location !== 'undefined')\r\n      location.href = LoginHelper.GetAccessDeniedRoute(originalPath);\r\n  }\r\n\r\n  static ClientRedirectToPath(redirectPath) {\r\n    if (typeof redirectPath === 'string') {\r\n      if (typeof location !== 'undefined') window.location.href = redirectPath;\r\n    } else LoginHelper.ClientRedirectToHome();\r\n  }\r\n\r\n  static async WsFedLogin(redirectUri) {\r\n    const userManager = await createUserManager(userManagerConfig);\r\n    userManager.signinRedirect({\r\n      scope: 'openid',\r\n      response_type: 'id_token',\r\n      redirect_uri: redirectUri || window.location.toString(),\r\n    });\r\n  }\r\n\r\n  static RemoveSecurityTokenQuery() {\r\n    const params = new URLSearchParams(window.location.search);\r\n    if (params.has('securitytoken') || params.has('securityToken')) {\r\n      params.delete('securitytoken');\r\n      params.delete('securityToken');\r\n      window.location = `${window.location.pathname}${\r\n        params.toString() ? `?${params}` : ''\r\n      }`;\r\n    }\r\n  }\r\n\r\n  static async WsFedLogout(redirectPath) {\r\n    await fetch(\r\n      `${LoginHelper.CMS_URL}/authenticate/logout?jsonResponseRequired=true`,\r\n      {\r\n        credentials: 'include',\r\n      }\r\n    );\r\n    if (redirectPath) {\r\n      window.location = redirectPath;\r\n    } else {\r\n      // Explicitly check and remove any stale\r\n      // security token that may be in the query string\r\n      LoginHelper.RemoveSecurityTokenQuery();\r\n    }\r\n  }\r\n\r\n  static async GetCredentialsForSecurityToken(securityToken) {\r\n    const [error, response] = await to(\r\n      fetch(`${LoginHelper.CMS_URL}/REST/Contensis/Security/IsAuthenticated`, {\r\n        method: 'POST',\r\n        headers: {\r\n          Accept: 'application/json',\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          securityToken: encodeURIComponent(securityToken),\r\n        }),\r\n      })\r\n    );\r\n    if (error) return [{ message: 'Failed to fetch credentials' }];\r\n    if (response.ok) {\r\n      const [parseError, body] = await to(response.json());\r\n      if (parseError) return [parseError];\r\n\r\n      const { LogonResult, ApplicationData = [] } = body;\r\n      if (LogonResult !== 0) {\r\n        console.info(`Security token is invalid - LogonResult: ${LogonResult}`);\r\n        return [\r\n          { message: 'Security token is invalid', data: ApplicationData },\r\n        ];\r\n      }\r\n      if (ApplicationData.length > 0) {\r\n        let refreshToken;\r\n        ApplicationData.forEach(item => {\r\n          if (item.Key === 'ContensisSecurityRefreshToken')\r\n            refreshToken = item.Value;\r\n        });\r\n        if (!refreshToken) {\r\n          return [\r\n            {\r\n              message:\r\n                'Fetch credentials: Unable to find ContensisSecurityRefreshToken',\r\n            },\r\n          ];\r\n        }\r\n        return [undefined, refreshToken];\r\n      } else {\r\n        return [\r\n          {\r\n            message:\r\n              'Fetch credentials: Unable to find ContensisSecurityRefreshToken',\r\n          },\r\n        ];\r\n      }\r\n    } else {\r\n      return [\r\n        {\r\n          message: `Fetch credentials error: ${response.status} ${response.statusText}`,\r\n        },\r\n      ];\r\n    }\r\n  }\r\n\r\n  // static isZengentiStaff(email) {\r\n  //   const emailRefs = ['@zengenti', '@contensis'];\r\n\r\n  //   return emailRefs.some(emailRef => {\r\n  //     if (email.includes(emailRef)) {\r\n  //       return true;\r\n  //     }\r\n  //   });\r\n  // }\r\n}\r\n","import { takeEvery, select, put, call } from 'redux-saga/effects';\r\nimport {\r\n  SET_AUTHENTICATION_STATE,\r\n  LOGIN_USER,\r\n  LOGOUT_USER,\r\n  VALIDATE_USER,\r\n} from '../types';\r\nimport {\r\n  selectUserIsAuthenticated,\r\n  selectClientCredentials,\r\n  selectUserGroups,\r\n} from '../selectors';\r\n\r\nimport { setRoute } from '~/routing/redux/actions';\r\nimport { selectCurrentSearch } from '~/routing/redux/selectors';\r\nimport { findContentTypeMapping } from '~/routing/util/find-contenttype-mapping';\r\n\r\nimport mapClientCredentials from '~/user/transformations/mapClientCredentials';\r\n\r\nimport { getManagementApiClient } from '~/user/util/ContensisManagementApi';\r\nimport { LoginHelper } from '~/user/util/LoginHelper.class';\r\nimport { matchUserGroup } from '~/user/util/matchGroups';\r\nimport { queryParams } from '~/util/navigation';\r\n\r\nexport const loginSagas = [\r\n  takeEvery(LOGIN_USER, loginUserSaga),\r\n  takeEvery(LOGOUT_USER, logoutUserSaga),\r\n  takeEvery(VALIDATE_USER, validateUserSaga),\r\n  takeEvery(SET_AUTHENTICATION_STATE, redirectAfterSuccessfulLoginSaga),\r\n];\r\n\r\nexport function* handleRequiresLoginSaga(action) {\r\n  const {\r\n    cookies,\r\n    entry,\r\n    path,\r\n    requireLogin,\r\n    routes: { ContentTypeMappings },\r\n    staticRoute,\r\n  } = action;\r\n  let userLoggedIn = yield select(selectUserIsAuthenticated);\r\n\r\n  // Check for a securityToken in querystring\r\n  const currentQs = queryParams(yield select(selectCurrentSearch));\r\n  const securityToken = currentQs.securityToken || currentQs.securitytoken;\r\n\r\n  // Check if any of the defined routes have \"requireLogin\" attribute\r\n  const { requireLogin: authRoute } = (staticRoute && staticRoute.route) || {};\r\n  const { requireLogin: authContentType } =\r\n    (entry &&\r\n      findContentTypeMapping(ContentTypeMappings, entry?.sys?.contentTypeId)) ||\r\n    {};\r\n\r\n  // If requireLogin, authRoute or authContentType has been specified as an\r\n  // array of groups we can merge all the arrays and match on any group supplied\r\n  const routeRequiresGroups = [\r\n    ...((Array.isArray(authContentType) && authContentType) || []),\r\n    ...((Array.isArray(authRoute) && authRoute) || []),\r\n    ...((Array.isArray(requireLogin) && requireLogin) || []),\r\n  ];\r\n  const routeRequiresLogin = !!authContentType || !!authRoute || !!requireLogin;\r\n\r\n  if (!userLoggedIn) {\r\n    // If cookies or securityToken are found on any route change\r\n    // always validate and login the user\r\n    if (routeRequiresLogin) {\r\n      console.info(`Route requires login: ${path}`);\r\n      // If routeRequiresLogin do a blocking call that returns userLoggedIn\r\n      userLoggedIn = yield call(validateUserSaga, {\r\n        cookies,\r\n        securityToken,\r\n      });\r\n      console.info(`User logged in: ${userLoggedIn}`);\r\n    }\r\n    // otherwise do a non blocking put to handle validation in the background\r\n    else yield put({ type: VALIDATE_USER, cookies, securityToken });\r\n  }\r\n\r\n  if (routeRequiresLogin) {\r\n    // If a security token is in the querystring and we are not already\r\n    // logged in something is wrong and we won't bother going on another redirect loop\r\n    if (!userLoggedIn && !securityToken) {\r\n      LoginHelper.ClientRedirectToSignInPage(action.location.pathname);\r\n    } else if (routeRequiresGroups.length > 0) {\r\n      const userGroups = yield select(selectUserGroups, 'js');\r\n      const groupMatch = matchUserGroup(userGroups, routeRequiresGroups);\r\n\r\n      if (!groupMatch)\r\n        LoginHelper.ClientRedirectToAccessDeniedPage(action.location.pathname);\r\n    }\r\n  }\r\n\r\n  return userLoggedIn;\r\n}\r\n\r\nfunction* validateUserSaga({ cookies, securityToken }) {\r\n  const login = LoginHelper.withCookies(cookies);\r\n  // Check for refreshToken in cookies\r\n  let clientCredentials = login.GetCachedCredentials();\r\n\r\n  if (\r\n    securityToken ||\r\n    clientCredentials.securityToken ||\r\n    clientCredentials.refreshToken\r\n  ) {\r\n    // We only attempt to validate the user if one of the stored\r\n    // tokens are found, in this case we set loading state manually\r\n    // so we don't need to set and unset loading if there are no stored\r\n    yield put({\r\n      type: SET_AUTHENTICATION_STATE,\r\n      authenticationState: {\r\n        isLoading: true,\r\n      },\r\n    });\r\n    // If we have just a security token we will call a CMS endpoint\r\n    // and provide us with a RefreshToken cookie we can use during login\r\n    if (\r\n      securityToken ||\r\n      (clientCredentials.securityToken && !clientCredentials.refreshToken)\r\n    ) {\r\n      const [error, refreshToken] =\r\n        yield LoginHelper.GetCredentialsForSecurityToken(\r\n          securityToken || clientCredentials.securityToken\r\n        );\r\n      if (refreshToken) {\r\n        // Set cookies and reload values\r\n        login.SetLoginCookies({\r\n          contensisClassicToken: securityToken,\r\n          refreshToken,\r\n        });\r\n        clientCredentials = login.GetCachedCredentials();\r\n      }\r\n      if (error) {\r\n        login.ClearCachedCredentials();\r\n        yield put({\r\n          type: SET_AUTHENTICATION_STATE,\r\n          authenticationState: {\r\n            isError: true,\r\n            errorMessage:\r\n              error?.message ||\r\n              (error && 'toString' in error && error.toString()),\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    // Log the user in if a refreshToken is found\r\n    if (clientCredentials.refreshToken) {\r\n      console.info(\r\n        `Login user with refreshToken ${clientCredentials.refreshToken}`\r\n      );\r\n      yield call(loginUserSaga, {\r\n        clientCredentials,\r\n        cookies: login.cookies,\r\n      });\r\n    }\r\n  }\r\n\r\n  // Tell any callers have we successfully logged in?\r\n  return yield select(selectUserIsAuthenticated);\r\n}\r\n\r\nfunction* loginUserSaga(action = {}) {\r\n  const { username, password, clientCredentials, cookies } = action;\r\n  const login = LoginHelper.withCookies(cookies);\r\n\r\n  // If a WSFED_LOGIN site has dispatched the loginUser action\r\n  // just redirect them to the Identity Provider sign in\r\n  if (action.type === LOGIN_USER && LoginHelper.WSFED_LOGIN)\r\n    LoginHelper.ClientRedirectToSignInPage();\r\n\r\n  const { authenticationState, user } = yield login.LoginUser({\r\n    username,\r\n    password,\r\n    clientCredentials,\r\n  });\r\n\r\n  yield put({\r\n    type: SET_AUTHENTICATION_STATE,\r\n    authenticationState,\r\n    user,\r\n  });\r\n}\r\n\r\nconst removeHostnamePart = path => {\r\n  // eslint-disable-next-line no-console\r\n  console.log(path);\r\n  const relativePath = '/' + path.split('/').splice(3).join('/');\r\n  // eslint-disable-next-line no-console\r\n  console.log(relativePath);\r\n  return relativePath;\r\n};\r\n\r\nfunction* redirectAfterSuccessfulLoginSaga() {\r\n  const isLoggedIn = yield select(selectUserIsAuthenticated);\r\n  const { redirect_uri: redirectPath, ReturnURL: assetRedirectPath } =\r\n    queryParams(yield select(selectCurrentSearch));\r\n\r\n  if (isLoggedIn && assetRedirectPath && typeof window != 'undefined') {\r\n    const path = removeHostnamePart(assetRedirectPath);\r\n    // This has to be a hard href to get the app to\r\n    // leave React and hit the server for the IIS hosted assets\r\n    window.location.href = path;\r\n    // yield put(setRoute(path)); // does not work in this scenario\r\n  } else if (isLoggedIn && redirectPath) {\r\n    yield put(setRoute(redirectPath));\r\n  }\r\n}\r\n\r\nfunction* logoutUserSaga({ redirectPath, cookies }) {\r\n  yield put({\r\n    type: SET_AUTHENTICATION_STATE,\r\n    user: null,\r\n  });\r\n  yield LoginHelper.withCookies(cookies).LogoutUser(redirectPath);\r\n}\r\n\r\nexport function* refreshSecurityToken() {\r\n  const clientCredentials = yield select(selectClientCredentials, 'js');\r\n  if (Object.keys(clientCredentials).length > 0) {\r\n    const client = yield getManagementApiClient(clientCredentials);\r\n    yield client.authenticate();\r\n\r\n    yield put({\r\n      type: SET_AUTHENTICATION_STATE,\r\n      authenticationState: {\r\n        clientCredentials: mapClientCredentials(client),\r\n      },\r\n    });\r\n  }\r\n}\r\n","import { action } from '~/redux/util';\r\nimport {\r\n  CHANGE_USER_PASSWORD,\r\n  LOGIN_USER,\r\n  LOGOUT_USER,\r\n  REGISTER_USER,\r\n  REQUEST_USER_PASSWORD_RESET,\r\n  RESET_USER_PASSWORD,\r\n} from './types';\r\n\r\nexport const loginUser = (username, password, cookies) =>\r\n  action(LOGIN_USER, { username, password, cookies });\r\n\r\nexport const logoutUser = (redirectPath, cookies) =>\r\n  action(LOGOUT_USER, { redirectPath, cookies });\r\n\r\nexport const registerUser = (user, mappers) =>\r\n  action(REGISTER_USER, {\r\n    user,\r\n    mappers,\r\n  });\r\n\r\nexport const requestPasswordReset = userEmailObject =>\r\n  action(REQUEST_USER_PASSWORD_RESET, { userEmailObject });\r\n\r\nexport const resetPassword = resetPasswordObject =>\r\n  action(RESET_USER_PASSWORD, { resetPasswordObject });\r\n\r\nexport const changePassword = (userId, currentPassword, newPassword) =>\r\n  action(CHANGE_USER_PASSWORD, { userId, currentPassword, newPassword });\r\n","import { useCookies } from 'react-cookie';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { loginUser, logoutUser } from '../redux/actions';\r\nimport {\r\n  selectUser,\r\n  selectUserIsAuthenticationError,\r\n  selectUserIsError,\r\n  selectUserErrorMessage,\r\n  selectUserIsAuthenticated,\r\n  selectUserIsLoading,\r\n} from '../redux/selectors';\r\nimport { CookieHelper } from '../util/CookieHelper.class';\r\n\r\nconst useLogin = () => {\r\n  const cookies = new CookieHelper(...useCookies());\r\n\r\n  const dispatch = useDispatch();\r\n  const select = useSelector;\r\n\r\n  return {\r\n    loginUser: (username, password) =>\r\n      dispatch(loginUser(username, password, cookies)),\r\n    logoutUser: redirectPath => dispatch(logoutUser(redirectPath, cookies)),\r\n    errorMessage: select(selectUserErrorMessage),\r\n    isAuthenticated: select(selectUserIsAuthenticated),\r\n    isAuthenticationError: select(selectUserIsAuthenticationError),\r\n    isError: select(selectUserIsError),\r\n    isLoading: select(selectUserIsLoading),\r\n    user: select(selectUser),\r\n    // DEPRECATED: authenticationError is deprecated use isAuthenticationError instead\r\n    authenticationError: select(selectUserIsAuthenticationError),\r\n    // DEPRECATED: authenticationErrorMessage is deprecated use errorMessage instead\r\n    authenticationErrorMessage: select(selectUserErrorMessage),\r\n    // DEPRECATED: error is deprecated use isError instead\r\n    error: select(selectUserIsError),\r\n  };\r\n};\r\n\r\nexport default useLogin;\r\n","import useLogin from '../hooks/useLogin';\r\nimport { toJS } from '~/util/ToJs';\r\n\r\nconst LoginContainer = ({ children, ...props }) => {\r\n  const userProps = useLogin(props);\r\n  return children(userProps);\r\n};\r\n\r\nLoginContainer.propTypes = {};\r\n\r\nexport default toJS(LoginContainer);\r\n","import { useDispatch, useSelector } from 'react-redux';\r\nimport { registerUser } from '../redux/actions';\r\nimport {\r\n  selectUserRegistration,\r\n  selectUserRegistrationError,\r\n  selectUserRegistrationIsLoading,\r\n  selectUserRegistrationIsSuccess,\r\n} from '../redux/selectors';\r\n\r\nconst useRegistration = () => {\r\n  const dispatch = useDispatch();\r\n  const select = useSelector;\r\n\r\n  return {\r\n    registerUser: (user, mappers) => dispatch(registerUser(user, mappers)),\r\n    error: select(selectUserRegistrationError),\r\n    isLoading: select(selectUserRegistrationIsLoading),\r\n    isSuccess: select(selectUserRegistrationIsSuccess),\r\n    user: select(selectUserRegistration),\r\n  };\r\n};\r\n\r\nexport default useRegistration;\r\n","import useRegistration from '../hooks/useRegistration';\r\nimport { toJS } from '~/util/ToJs';\r\n\r\nconst RegistrationContainer = ({ children, ...props }) => {\r\n  const userProps = useRegistration(props);\r\n  return children(userProps);\r\n};\r\n\r\nRegistrationContainer.propTypes = {};\r\n\r\nexport default toJS(RegistrationContainer);\r\n","import { useDispatch, useSelector } from 'react-redux';\r\nimport { requestPasswordReset, resetPassword } from '../redux/actions';\r\nimport {\r\n  selectPasswordResetRequestError,\r\n  selectPasswordResetRequestSending,\r\n  selectPasswordResetRequestSent,\r\n  selectResetPasswordSending,\r\n  selectResetPasswordSent,\r\n  selectResetPasswordError,\r\n} from '../redux/selectors';\r\nimport { selectCurrentSearch } from '~/routing/redux/selectors';\r\n\r\nconst useForgotPassword = () => {\r\n  const dispatch = useDispatch();\r\n  const select = useSelector;\r\n\r\n  return {\r\n    isLoading: select(selectPasswordResetRequestSending),\r\n    isSuccess: select(selectPasswordResetRequestSent),\r\n    error: select(selectPasswordResetRequestError),\r\n    requestPasswordReset: userEmailObject =>\r\n      dispatch(requestPasswordReset(userEmailObject)),\r\n\r\n    setNewPassword: {\r\n      queryString: select(selectCurrentSearch),\r\n      isLoading: select(selectResetPasswordSending),\r\n      isSuccess: select(selectResetPasswordSent),\r\n      error: select(selectResetPasswordError),\r\n      submit: resetPasswordObject =>\r\n        dispatch(resetPassword(resetPasswordObject)),\r\n    },\r\n  };\r\n};\r\n\r\nexport default useForgotPassword;\r\n","import useForgotPassword from '../hooks/useForgotPassword';\r\nimport { toJS } from '~/util/ToJs';\r\n\r\nconst ForgotPasswordContainer = ({ children, ...props }) => {\r\n  const userProps = useForgotPassword(props);\r\n  return children(userProps);\r\n};\r\n\r\nForgotPasswordContainer.propTypes = {};\r\n\r\nexport default toJS(ForgotPasswordContainer);\r\n","import { useDispatch, useSelector } from 'react-redux';\r\nimport { changePassword } from '../redux/actions';\r\nimport {\r\n  selectChangePasswordSending,\r\n  selectChangePasswordSent,\r\n  selectChangePasswordError,\r\n  selectUserIsAuthenticated,\r\n  selectUserGuid,\r\n} from '../redux/selectors';\r\n\r\nconst useChangePassword = () => {\r\n  const dispatch = useDispatch();\r\n  const select = useSelector;\r\n\r\n  return {\r\n    isLoading: select(selectChangePasswordSending),\r\n    isSuccess: select(selectChangePasswordSent),\r\n    userId: select(selectUserGuid),\r\n    isLoggedIn: select(selectUserIsAuthenticated),\r\n    error: select(selectChangePasswordError),\r\n    changePassword: (userId, currentPassword, newPassword) =>\r\n      dispatch(changePassword(userId, currentPassword, newPassword)),\r\n  };\r\n};\r\n\r\nexport default useChangePassword;\r\n","import useChangePassword from '../hooks/useChangePassword';\r\nimport { toJS } from '~/util/ToJs';\r\n\r\nconst ChangePasswordContainer = ({ children, ...props }) => {\r\n  const userProps = useChangePassword(props);\r\n  return children(userProps);\r\n};\r\n\r\nChangePasswordContainer.propTypes = {};\r\n\r\nexport default toJS(ChangePasswordContainer);\r\n"],"names":["findContentTypeMapping","ContentTypeMappings","contentTypeId","find","ct","contentTypeID","clientCredentials","bearerToken","bearerTokenExpiryDate","toISOString","refreshToken","refreshTokenExpiryDate","contensisClassicToken","obj","mapJson","getManagementApiClient","username","password","rootUrl","SERVERS","api","cms","projectId","PROJECTS","id","config","clientType","clientDetails","Client","window","UniversalClient","client","create","context","global","requireOidc","process","env","NODE_ENV","WSFED_LOGIN","servers","userManagerConfig","authority","client_id","redirect_uri","location","toString","post_logout_redirect_uri","response_type","scope","filterProtocolClaims","createUserManager","UserManager","e","console","error","LoginHelper","constructor","cookies","SetLoginCookies","info","LOGIN_COOKIE","REFRESH_TOKEN_COOKIE","SetCookie","GetCachedCredentials","GetCookie","ClearCachedCredentials","DeleteCookie","localStorage","keys","i","length","key","startsWith","push","forEach","removeItem","LoginUser","credentials","authenticationState","isAuthenticated","isAuthenticationError","isError","transientClient","user","loginError","clientBearerToken","to","ensureBearerToken","errorMessage","message","name","includes","mapClientCredentials","userDetails","GetUserDetails","latestCredentials","LogoutUser","redirectPath","WsFedLogout","ClientRedirectToPath","ClientRedirectToSignInPage","ClientRedirectToHome","url","search","hash","href","WsFedLogin","LOGIN_ROUTE","replace","GetAccessDeniedRoute","originalPath","ACCESS_DENIED_ROUTE","ClientRedirectToAccessDeniedPage","redirectUri","userManager","signinRedirect","RemoveSecurityTokenQuery","params","URLSearchParams","has","delete","pathname","fetch","CMS_URL","GetCredentialsForSecurityToken","securityToken","response","method","headers","Accept","body","JSON","stringify","encodeURIComponent","ok","parseError","json","LogonResult","ApplicationData","data","item","Key","Value","undefined","status","statusText","withCookies","cookieHelper","userError","groupsError","groupsResult","security","users","getCurrent","getUserGroups","userId","includeInherited","pageOptions","pageSize","items","groups","log","loginSagas","takeEvery","LOGIN_USER","loginUserSaga","LOGOUT_USER","logoutUserSaga","VALIDATE_USER","validateUserSaga","SET_AUTHENTICATION_STATE","redirectAfterSuccessfulLoginSaga","handleRequiresLoginSaga","action","_entry$sys","entry","path","requireLogin","routes","staticRoute","userLoggedIn","select","selectUserIsAuthenticated","currentQs","queryParams","selectCurrentSearch","securitytoken","authRoute","route","authContentType","sys","routeRequiresGroups","Array","isArray","routeRequiresLogin","call","put","type","userGroups","selectUserGroups","groupMatch","matchUserGroup","login","isLoading","removeHostnamePart","relativePath","split","splice","join","isLoggedIn","ReturnURL","assetRedirectPath","setRoute","refreshSecurityToken","selectClientCredentials","Object","authenticate","loginUser","logoutUser","registerUser","mappers","REGISTER_USER","requestPasswordReset","userEmailObject","REQUEST_USER_PASSWORD_RESET","resetPassword","resetPasswordObject","RESET_USER_PASSWORD","changePassword","currentPassword","newPassword","CHANGE_USER_PASSWORD","useLogin","CookieHelper","useCookies","dispatch","useDispatch","useSelector","selectUserErrorMessage","selectUserIsAuthenticationError","selectUserIsError","selectUserIsLoading","selectUser","authenticationError","authenticationErrorMessage","LoginContainer","children","props","userProps","propTypes","toJS","useRegistration","selectUserRegistrationError","selectUserRegistrationIsLoading","isSuccess","selectUserRegistrationIsSuccess","selectUserRegistration","RegistrationContainer","useForgotPassword","selectPasswordResetRequestSending","selectPasswordResetRequestSent","selectPasswordResetRequestError","setNewPassword","queryString","selectResetPasswordSending","selectResetPasswordSent","selectResetPasswordError","submit","ForgotPasswordContainer","useChangePassword","selectChangePasswordSending","selectChangePasswordSent","selectUserGuid","selectChangePasswordError","ChangePasswordContainer"],"mappings":"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"}