{"version":3,"file":"ToJs-42cadab5.js","sources":["../src/user/redux/selectors.ts","../src/user/util/matchGroups.ts","../src/user/util/CookieHelper.class.ts","../src/util/ToJs.tsx"],"sourcesContent":["import { StateType } from '~/config';\r\nimport { AppState } from '~/redux/appstate';\r\nimport { getImmutableOrJS as getIn } from '~/redux/util';\r\n\r\nexport const selectUserIsLoading = (state: AppState) =>\r\n  getIn(state, ['user', 'authenticationState', 'isLoading']);\r\n\r\nexport const selectUserIsAuthenticated = (state: AppState) =>\r\n  getIn(state, ['user', 'authenticationState', 'isAuthenticated']);\r\n\r\nexport const selectUserIsAuthenticationError = (state: AppState) =>\r\n  getIn(state, ['user', 'authenticationState', 'isAuthenticationError']);\r\n\r\nexport const selectUserIsError = (state: AppState) =>\r\n  getIn(state, ['user', 'authenticationState', 'isError']);\r\n\r\n/**\r\n * DEPRECATED 12/2021 - use selectUserErrorMessage instead\r\n * @param state AppState\r\n * @returns string\r\n */\r\nexport const selectUserAuthenticationErrorMessage = (state: AppState) =>\r\n  getIn(state, ['user', 'authenticationState', 'errorMessage']);\r\n\r\nexport const selectUserErrorMessage = (state: AppState) =>\r\n  getIn(state, ['user', 'authenticationState', 'errorMessage']);\r\n\r\nexport const selectClientCredentials = (\r\n  state: AppState,\r\n  returnType?: StateType\r\n) =>\r\n  getIn(\r\n    state,\r\n    ['user', 'authenticationState', 'clientCredentials'],\r\n    {},\r\n    returnType\r\n  );\r\n\r\nexport const selectUser = (state: AppState, returnType?: StateType) =>\r\n  getIn(state, 'user', {}, returnType);\r\n\r\nexport const selectUserIsZengentiStaff = (state: AppState) =>\r\n  getIn(state, ['user', 'isZengentiStaff']);\r\n\r\nexport const selectUserGuid = (state: AppState) => getIn(state, ['user', 'id']);\r\n\r\nexport const selectUsername = (state: AppState) =>\r\n  getIn(state, ['user', 'username']);\r\n\r\nexport const selectUserEmail = (state: AppState) =>\r\n  getIn(state, ['user', 'email']);\r\n\r\nexport const selectUserGroups = (state: AppState, returnType?: StateType) =>\r\n  getIn(state, ['user', 'groups'], [], returnType);\r\n\r\nexport const selectUserSecurityToken = (state: AppState) =>\r\n  getIn(state, [\r\n    'user',\r\n    'authenticationState',\r\n    'clientCredentials',\r\n    'contensisClassicToken',\r\n  ]);\r\n\r\nexport const selectUserRegistration = (\r\n  state: AppState,\r\n  returnType?: StateType\r\n) => getIn(state, ['user', 'registration'], {}, returnType);\r\n\r\nexport const selectUserRegistrationError = (state: AppState) =>\r\n  getIn(state, ['user', 'registration', 'error'], false);\r\n\r\nexport const selectUserRegistrationIsLoading = (state: AppState) =>\r\n  getIn(state, ['user', 'registration', 'isLoading'], false);\r\n\r\nexport const selectUserRegistrationIsSuccess = (state: AppState) =>\r\n  getIn(state, ['user', 'registration', 'success'], false);\r\n\r\nexport const selectPasswordResetRequestSending = (state: AppState) =>\r\n  getIn(state, ['user', 'passwordResetRequest', 'isSending']);\r\n\r\nexport const selectPasswordResetRequestSent = (state: AppState) =>\r\n  getIn(state, ['user', 'passwordResetRequest', 'sent']);\r\n\r\nexport const selectPasswordResetRequestError = (state: AppState) =>\r\n  getIn(state, ['user', 'passwordResetRequest', 'error']);\r\n\r\nexport const selectResetPasswordSending = (state: AppState) =>\r\n  getIn(state, ['user', 'resetPassword', 'isSending']);\r\n\r\nexport const selectResetPasswordSent = (state: AppState) =>\r\n  getIn(state, ['user', 'resetPassword', 'sent']);\r\n\r\nexport const selectResetPasswordError = (state: AppState) =>\r\n  getIn(state, ['user', 'resetPassword', 'error']);\r\n\r\nexport const selectChangePasswordSending = (state: AppState) =>\r\n  getIn(state, ['user', 'changePassword', 'isSending']);\r\n\r\nexport const selectChangePasswordSent = (state: AppState) =>\r\n  getIn(state, ['user', 'changePassword', 'sent']);\r\n\r\nexport const selectChangePasswordError = (state: AppState) =>\r\n  getIn(state, ['user', 'changePassword', 'error']);\r\n","import { Group } from 'contensis-management-api/lib/models';\r\nimport { RequireLogin } from '~/routing/routes';\r\n\r\nexport const matchUserGroup = (\r\n  userGroups: Group[] = [],\r\n  requiredGroups: RequireLogin = []\r\n) => {\r\n  if (\r\n    !Array.isArray(requiredGroups) ||\r\n    (Array.isArray(requiredGroups) && requiredGroups.length === 0)\r\n  )\r\n    return true;\r\n\r\n  const groupMatch = requiredGroups.some(requiredGroup => {\r\n    return userGroups.some(userGroup => {\r\n      if (requiredGroup.id === userGroup.id) {\r\n        return true;\r\n      }\r\n      if (requiredGroup.name === userGroup.name) {\r\n        return true;\r\n      }\r\n    });\r\n  });\r\n  return groupMatch;\r\n};\r\n","import { useCookies } from 'react-cookie';\r\n\r\nconst COOKIE_VALID_DAYS = 1; // 0 = Session cookie\r\n\r\ntype CookieHook = ReturnType<typeof useCookies>;\r\ntype Cookies = { [k: string]: string };\r\ntype SetCookie = CookieHook[1];\r\ntype RemoveCookie = CookieHook[2];\r\n\r\n// CookieHelper is a class that takes in and lets us pass around the methods provided\r\n// by `useCookie` react hook in backend code that is connected to the universal-cookies\r\n// instance created in SSR middleware (and provides browser cookies)\r\nexport class CookieHelper {\r\n  private cookies: Cookies;\r\n  private setCookie: SetCookie;\r\n  private removeCookie: RemoveCookie;\r\n\r\n  get raw() {\r\n    return this.cookies;\r\n  }\r\n\r\n  constructor(\r\n    cookies: { [k: string]: string },\r\n    setCookie: CookieHelper['setCookie'],\r\n    removeCookie: CookieHelper['removeCookie']\r\n  ) {\r\n    this.cookies = cookies;\r\n    this.setCookie = setCookie;\r\n    this.removeCookie = removeCookie;\r\n  }\r\n\r\n  GetCookie(name: string) {\r\n    const cookie = this.cookies[name];\r\n    if (typeof cookie === 'undefined') {\r\n      return null;\r\n    }\r\n    return cookie;\r\n  }\r\n\r\n  SetCookie(name: string, value: string, maxAgeDays = COOKIE_VALID_DAYS) {\r\n    // update local cookies object as this is provided as a clone of `req.universalCookies`\r\n    this.cookies[name] = value;\r\n\r\n    // call the passed setCookie method so we can update the `universal-cookie` instance\r\n    // with the change listener attached so the cookies can be set in SSR response\r\n    if (maxAgeDays === 0) this.setCookie(name, value);\r\n    else\r\n      this.setCookie(name, value, {\r\n        expires: addDays(new Date(), maxAgeDays),\r\n      });\r\n  }\r\n\r\n  DeleteCookie(name: string) {\r\n    // update local cookies object as this is provided as a clone of `req.universalCookies`\r\n    delete this.cookies[name];\r\n\r\n    this.removeCookie(name);\r\n  }\r\n}\r\nconst addDays = (date = new Date(), days: number) => {\r\n  const result = new Date(date);\r\n  result.setDate(result.getDate() + days);\r\n  return result;\r\n};\r\n\r\nexport const mapCookieHeader = cookies =>\r\n  typeof cookies === 'object'\r\n    ? Object.entries(cookies)\r\n        .map(([name, value]) => `${name}=${value}`)\r\n        .join('; ')\r\n    : cookies;\r\n","/* eslint-disable react/display-name */\r\n/* eslint-disable @typescript-eslint/naming-convention */\r\nimport React from 'react';\r\n\r\nexport const toJS =\r\n  <Props extends { [key: string]: any }>(\r\n    WrappedComponent: React.ComponentType<Props>\r\n  ) =>\r\n  (wrappedComponentProps: Props) => {\r\n    const KEY = 0;\r\n    const VALUE = 1;\r\n\r\n    const propsJS = Object.entries(wrappedComponentProps).reduce<Props>(\r\n      (newProps: any, wrappedComponentProp) => {\r\n        const propKey = wrappedComponentProp[KEY];\r\n        const propValue = wrappedComponentProp[VALUE];\r\n        newProps[propKey] =\r\n          propValue && typeof propValue === 'object' && 'toJS' in propValue\r\n            ? propValue.toJS()\r\n            : propValue;\r\n        return newProps as Props;\r\n      },\r\n      {} as Props\r\n    );\r\n\r\n    return <WrappedComponent {...propsJS} />;\r\n  };\r\n"],"names":["selectUserIsLoading","state","getIn","selectUserIsAuthenticated","selectUserIsAuthenticationError","selectUserIsError","selectUserAuthenticationErrorMessage","selectUserErrorMessage","selectClientCredentials","returnType","selectUser","selectUserIsZengentiStaff","selectUserGuid","selectUsername","selectUserEmail","selectUserGroups","selectUserSecurityToken","selectUserRegistration","selectUserRegistrationError","selectUserRegistrationIsLoading","selectUserRegistrationIsSuccess","selectPasswordResetRequestSending","selectPasswordResetRequestSent","selectPasswordResetRequestError","selectResetPasswordSending","selectResetPasswordSent","selectResetPasswordError","selectChangePasswordSending","selectChangePasswordSent","selectChangePasswordError","matchUserGroup","userGroups","requiredGroups","Array","isArray","length","groupMatch","some","requiredGroup","userGroup","id","name","COOKIE_VALID_DAYS","CookieHelper","raw","cookies","constructor","setCookie","removeCookie","GetCookie","cookie","SetCookie","value","maxAgeDays","expires","addDays","Date","DeleteCookie","date","days","result","setDate","getDate","toJS","WrappedComponent","wrappedComponentProps","KEY","VALUE","propsJS","Object","entries","reduce","newProps","wrappedComponentProp","propKey","propValue","React","createElement"],"mappings":"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"}