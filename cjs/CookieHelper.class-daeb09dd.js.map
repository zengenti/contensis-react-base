{"version":3,"file":"CookieHelper.class-daeb09dd.js","sources":["../src/user/util/CookieHelper.class.ts"],"sourcesContent":["import { useCookies } from 'react-cookie';\n\nconst COOKIE_VALID_DAYS = 1; // 0 = Session cookie\n\ntype CookieHook = ReturnType<typeof useCookies>;\ntype Cookies = { [k: string]: string };\ntype SetCookie = CookieHook[1];\ntype RemoveCookie = CookieHook[2];\n\n// CookieHelper is a class that takes in and lets us pass around the methods provided\n// by `useCookie` react hook in backend code that is connected to the universal-cookies\n// instance created in SSR middleware (and provides browser cookies)\nexport class CookieHelper {\n  private cookies: Cookies;\n  private setCookie: SetCookie;\n  private removeCookie: RemoveCookie;\n\n  get raw() {\n    return this.cookies;\n  }\n\n  constructor(\n    cookies: { [k: string]: string },\n    setCookie: CookieHelper['setCookie'],\n    removeCookie: CookieHelper['removeCookie']\n  ) {\n    this.cookies = cookies;\n    this.setCookie = setCookie;\n    this.removeCookie = removeCookie;\n  }\n\n  GetCookie(name: string) {\n    const cookie = this.cookies[name];\n    if (typeof cookie === 'undefined') {\n      return null;\n    }\n    return cookie;\n  }\n\n  SetCookie(name: string, value: string, maxAgeDays = COOKIE_VALID_DAYS) {\n    // update local cookies object as this is provided as a clone of `req.universalCookies`\n    this.cookies[name] = value;\n\n    // call the passed setCookie method so we can update the `universal-cookie` instance\n    // with the change listener attached so the cookies can be set in SSR response\n    if (maxAgeDays === 0) this.setCookie(name, value);\n    else\n      this.setCookie(name, value, {\n        expires: addDays(new Date(), maxAgeDays),\n      });\n  }\n\n  DeleteCookie(name: string) {\n    // update local cookies object as this is provided as a clone of `req.universalCookies`\n    delete this.cookies[name];\n\n    this.removeCookie(name);\n  }\n}\nconst addDays = (date = new Date(), days: number) => {\n  const result = new Date(date);\n  result.setDate(result.getDate() + days);\n  return result;\n};\n\nexport const mapCookieHeader = cookies =>\n  typeof cookies === 'object'\n    ? Object.entries(cookies)\n        .map(([name, value]) => `${name}=${value}`)\n        .join('; ')\n    : cookies;\n"],"names":["COOKIE_VALID_DAYS","CookieHelper","raw","cookies","constructor","setCookie","removeCookie","GetCookie","name","cookie","SetCookie","value","maxAgeDays","expires","addDays","Date","DeleteCookie","date","days","result","setDate","getDate","mapCookieHeader","Object","entries","map","join"],"mappings":";;AAEA,MAAMA,iBAAiB,GAAG,CAAC,CAAC;;AAO5B;AACA;AACA;AACO,MAAMC,YAAY,CAAC;EAKxB,IAAIC,GAAGA,GAAG;IACR,OAAO,IAAI,CAACC,OAAO,CAAA;AACrB,GAAA;AAEAC,EAAAA,WAAWA,CACTD,OAAgC,EAChCE,SAAoC,EACpCC,YAA0C,EAC1C;AAAA,IAAA,IAAA,CAZMH,OAAO,GAAA,KAAA,CAAA,CAAA;AAAA,IAAA,IAAA,CACPE,SAAS,GAAA,KAAA,CAAA,CAAA;AAAA,IAAA,IAAA,CACTC,YAAY,GAAA,KAAA,CAAA,CAAA;IAWlB,IAAI,CAACH,OAAO,GAAGA,OAAO,CAAA;IACtB,IAAI,CAACE,SAAS,GAAGA,SAAS,CAAA;IAC1B,IAAI,CAACC,YAAY,GAAGA,YAAY,CAAA;AAClC,GAAA;EAEAC,SAASA,CAACC,IAAY,EAAE;AACtB,IAAA,MAAMC,MAAM,GAAG,IAAI,CAACN,OAAO,CAACK,IAAI,CAAC,CAAA;AACjC,IAAA,IAAI,OAAOC,MAAM,KAAK,WAAW,EAAE;AACjC,MAAA,OAAO,IAAI,CAAA;AACb,KAAA;AACA,IAAA,OAAOA,MAAM,CAAA;AACf,GAAA;EAEAC,SAASA,CAACF,IAAY,EAAEG,KAAa,EAAEC,UAAU,GAAGZ,iBAAiB,EAAE;AACrE;AACA,IAAA,IAAI,CAACG,OAAO,CAACK,IAAI,CAAC,GAAGG,KAAK,CAAA;;AAE1B;AACA;IACA,IAAIC,UAAU,KAAK,CAAC,EAAE,IAAI,CAACP,SAAS,CAACG,IAAI,EAAEG,KAAK,CAAC,CAAC,KAEhD,IAAI,CAACN,SAAS,CAACG,IAAI,EAAEG,KAAK,EAAE;AAC1BE,MAAAA,OAAO,EAAEC,OAAO,CAAC,IAAIC,IAAI,EAAE,EAAEH,UAAU,CAAA;AACzC,KAAC,CAAC,CAAA;AACN,GAAA;EAEAI,YAAYA,CAACR,IAAY,EAAE;AACzB;AACA,IAAA,OAAO,IAAI,CAACL,OAAO,CAACK,IAAI,CAAC,CAAA;AAEzB,IAAA,IAAI,CAACF,YAAY,CAACE,IAAI,CAAC,CAAA;AACzB,GAAA;AACF,CAAA;AACA,MAAMM,OAAO,GAAGA,CAACG,IAAI,GAAG,IAAIF,IAAI,EAAE,EAAEG,IAAY,KAAK;AACnD,EAAA,MAAMC,MAAM,GAAG,IAAIJ,IAAI,CAACE,IAAI,CAAC,CAAA;EAC7BE,MAAM,CAACC,OAAO,CAACD,MAAM,CAACE,OAAO,EAAE,GAAGH,IAAI,CAAC,CAAA;AACvC,EAAA,OAAOC,MAAM,CAAA;AACf,CAAC,CAAA;MAEYG,eAAe,GAAGnB,OAAO,IACpC,OAAOA,OAAO,KAAK,QAAQ,GACvBoB,MAAM,CAACC,OAAO,CAACrB,OAAO,CAAC,CACpBsB,GAAG,CAAC,CAAC,CAACjB,IAAI,EAAEG,KAAK,CAAC,KAAM,GAAEH,IAAK,CAAA,CAAA,EAAGG,KAAM,CAAA,CAAC,CAAC,CAC1Ce,IAAI,CAAC,IAAI,CAAC,GACbvB;;;;;"}