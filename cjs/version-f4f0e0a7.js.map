{"version":3,"file":"version-f4f0e0a7.js","sources":["../src/redux/types/navigation.js","../src/redux/reducers/navigation.ts","../src/util/merge.ts","../src/routing/redux/reducers.ts","../src/redux/types/version.js","../src/redux/reducers/version.ts","../src/redux/store/routerMiddleware.js","../src/redux/store/store.ts","../src/redux/selectors/navigation.js","../src/redux/store/injectors.js","../src/redux/actions/version.js"],"sourcesContent":["const ACTION_PREFIX = '@NAVIGATION/';\r\nexport const GET_NODE_TREE = `${ACTION_PREFIX}_GET_NODE_TREE`;\r\nexport const SET_NODE_TREE = `${ACTION_PREFIX}_SET_NODE_TREE`;\r\nexport const GET_NODE_TREE_ERROR = `${ACTION_PREFIX}_GET_NODE_TREE_ERROR`;\r\n","import { Draft, produce } from 'immer';\r\nimport { SET_NODE_TREE, GET_NODE_TREE_ERROR } from '~/redux/types/navigation';\r\n\r\nconst initialState = {\r\n  root: null,\r\n  error: {\r\n    isError: false,\r\n    message: null,\r\n  },\r\n  isReady: false,\r\n};\r\n\r\nexport default produce((state: Draft<any>, action) => {\r\n  switch (action.type) {\r\n    case SET_NODE_TREE: {\r\n      state.root = action.nodes;\r\n      state.isReady = true;\r\n      return;\r\n    }\r\n    case GET_NODE_TREE_ERROR: {\r\n      state.error.isError = true;\r\n      state.error.message = action.error || 'Unknown error occurred';\r\n      return;\r\n    }\r\n    default:\r\n      return;\r\n  }\r\n}, initialState);\r\n","import merge from 'deepmerge';\r\n\r\nexport const combineMerge = (target: any, source: any, options: any) => {\r\n  const destination = target.slice();\r\n\r\n  source.forEach((item: any, index: any) => {\r\n    if (typeof destination[index] === 'undefined') {\r\n      destination[index] = options.cloneUnlessOtherwiseSpecified(item, options);\r\n    } else if (options.isMergeableObject(item)) {\r\n      destination[index] = merge(target[index], item, options);\r\n    } else if (target.indexOf(item) === -1) {\r\n      destination.push(item);\r\n    }\r\n  });\r\n  return destination;\r\n};\r\n","import { Draft, produce } from 'immer';\nimport merge from 'deepmerge';\n\nimport {\n  SET_ENTRY,\n  SET_NAVIGATION_PATH,\n  SET_ANCESTORS,\n  SET_TARGET_PROJECT,\n  SET_ROUTE,\n  SET_SIBLINGS,\n  SET_SURROGATE_KEYS,\n  UPDATE_LOADING_STATE,\n} from './types';\nimport { combineMerge } from '~/util/merge';\n\nconst initialState = {\n  currentHostname: null,\n  currentPath: '/',\n  currentNode: {},\n  currentNodeAncestors: [],\n  currentProject: 'unknown',\n  entryID: null,\n  entry: null,\n  error: undefined,\n  isError: false,\n  isLoading: false,\n  location: {},\n  mappedEntry: null,\n  notFound: false,\n  staticRoute: null,\n  statusCode: 200,\n};\n\nexport default produce((state: Draft<any>, action) => {\n  switch (action.type) {\n    case SET_ANCESTORS: {\n      state.currentNodeAncestors = action.ancestors;\n      return;\n    }\n    case SET_ENTRY: {\n      const {\n        entry,\n        error,\n        mappedEntry,\n        node = {},\n        isError = false,\n        isLoading = false,\n        notFound = false,\n        statusCode,\n      } = action;\n\n      let defaultStatus = 200;\n      if (notFound === true && isError === false) defaultStatus = 404;\n      else if (isError === true) defaultStatus = statusCode || 500;\n\n      if (!entry) {\n        state.entryID = null;\n        state.entry = null;\n        state.error = error;\n        state.mappedEntry = null;\n        state.isError = isError;\n        state.isLoading = isLoading;\n        state.notFound = notFound;\n        state.statusCode = statusCode || defaultStatus;\n      } else {\n        state.entryID = action.id;\n        state.entry = entry;\n        state.error = error;\n        state.isError = isError;\n        state.isLoading = isLoading;\n        state.notFound = notFound;\n        state.statusCode = statusCode || defaultStatus;\n\n        if (mappedEntry && Object.keys(mappedEntry).length > 0) {\n          state.mappedEntry = mappedEntry;\n          state.entry = { sys: entry.sys };\n        }\n      }\n\n      if (!node) {\n        state.currentNode = null;\n      } else {\n        // On Set Node, we reset all dependants.\n        state.currentNode = node;\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { entry, ...nodeWithoutEntry } = node; // We have the entry stored elsewhere, so lets not keep it twice.\n        state.currentNode = nodeWithoutEntry;\n      }\n      return;\n    }\n    case UPDATE_LOADING_STATE: {\n      state.isLoading = action.isLoading;\n      return;\n    }\n    case SET_NAVIGATION_PATH: {\n      let staticRoute = {} as any;\n      if (action.staticRoute) {\n        staticRoute = { ...action.staticRoute };\n      }\n      if (action.path) {\n        // Don't run a path update on initial load as we allready should have it in redux\n        const entryUri = state?.entry?.sys?.uri;\n        if (entryUri !== action.path) {\n          state.currentPath = action.path;\n          state.location = action.location;\n          state.staticRoute = {\n            ...staticRoute,\n            route: { ...staticRoute.route, element: null },\n          };\n\n          state.isLoading = typeof window !== 'undefined';\n        } else {\n          state.location = action.location;\n          state.staticRoute = {\n            ...staticRoute,\n            route: { ...staticRoute.route, element: null },\n          };\n        }\n      }\n      return;\n    }\n    case SET_ROUTE: {\n      state.nextPath = action.path;\n      return;\n    }\n    case SET_SIBLINGS: {\n      // Can be null in some cases like the homepage.\n      let currentNodeSiblingParent = null;\n      if (action.siblings && action.siblings.length > 0) {\n        currentNodeSiblingParent = action.siblings[0].parentId;\n      }\n\n      state.currentNodeSiblings = action.siblings;\n      state.currentNodeSiblingsParent = currentNodeSiblingParent;\n      return;\n    }\n    case SET_SURROGATE_KEYS: {\n      // console.info(`SET_SURROGATE_KEYS: '${action.url}' keys: ${action.keys}`);\n      state.surrogateKeys = merge(\n        state.surrogateKeys,\n        (action.keys || '').split(' '),\n        { arrayMerge: combineMerge }\n      );\n      return;\n    }\n    case SET_TARGET_PROJECT: {\n      state.currentProject = action.project;\n      state.allowedGroups = action.allowedGroups;\n      state.currentHostname = action.hostname;\n      return;\n    }\n    default:\n      return state;\n  }\n}, initialState);\n","const VERSION_PREFIX = '@VERSION/';\r\nexport const SET_VERSION = `${VERSION_PREFIX}SET_VERSION`;\r\nexport const SET_VERSION_STATUS = `${VERSION_PREFIX}SET_VERSION_STATUS`;\r\n","import { Draft, produce } from 'immer';\r\nimport { SET_VERSION, SET_VERSION_STATUS } from '~/redux/types/version';\r\n\r\nconst initialState = {\r\n  commitRef: null,\r\n  buildNo: null,\r\n  contensisVersionStatus: 'published',\r\n};\r\n\r\nexport default produce((state: Draft<any>, action) => {\r\n  switch (action.type) {\r\n    case SET_VERSION_STATUS: {\r\n      state.contensisVersionStatus = action.status;\r\n      return;\r\n    }\r\n    case SET_VERSION: {\r\n      state.commitRef = action.commitRef;\r\n      state.buildNo = action.buildNo;\r\n      return;\r\n    }\r\n    default:\r\n      return;\r\n  }\r\n}, initialState);\r\n","/**\r\n * This middleware captures 'CALL_HISTORY_METHOD' actions to redirect to the\r\n * provided history object. This will prevent these actions from reaching your\r\n * reducer or any middleware that comes after this one.\r\n */\r\n/* eslint-disable no-unused-vars */\r\nconst routerMiddleware = history => store => next => action => {\r\n  if (action.type !== 'CALL_HISTORY_METHOD') {\r\n    return next(action);\r\n  }\r\n\r\n  const {\r\n    payload: { method, args },\r\n  } = action;\r\n  history[method](...args);\r\n};\r\n\r\nexport default routerMiddleware;\r\n","import {\r\n  applyMiddleware,\r\n  combineReducers,\r\n  compose,\r\n  createStore,\r\n  Action,\r\n  Store,\r\n  StoreEnhancer,\r\n} from 'redux';\r\nimport thunkMiddleware from 'redux-thunk';\r\nimport createSagaMiddleware, { END } from 'redux-saga';\r\nimport { createInjectorsEnhancer } from 'redux-injectors';\r\n\r\n// Core reducers\r\nimport NavigationReducer from '../reducers/navigation';\r\nimport RoutingReducer from '~/routing/redux/reducers';\r\nimport UserReducer from '~/user/redux/reducers';\r\nimport VersionReducer from '../reducers/version';\r\nimport routerMiddleware from './routerMiddleware';\r\nimport { AppState } from '../appstate';\r\nimport { History, MemoryHistory } from 'history';\r\nimport { StateType } from '~/config';\r\n\r\nexport let reduxStore;\r\n\r\n/* eslint-disable no-underscore-dangle */\r\ndeclare let window: Window &\r\n  typeof globalThis & {\r\n    __REDUX_DEVTOOLS_EXTENSION__: any;\r\n  };\r\n\r\nexport default async (\r\n  featureReducers: any,\r\n  initialState: AppState,\r\n  history: History | MemoryHistory,\r\n  stateType: StateType\r\n) => {\r\n  let reduxDevToolsMiddleware = f => f;\r\n\r\n  if (typeof window != 'undefined') {\r\n    reduxDevToolsMiddleware = window.__REDUX_DEVTOOLS_EXTENSION__\r\n      ? window.__REDUX_DEVTOOLS_EXTENSION__()\r\n      : f => f;\r\n  }\r\n\r\n  const sagaMiddleware = createSagaMiddleware();\r\n\r\n  const reducers = {\r\n    navigation: NavigationReducer,\r\n    routing: RoutingReducer,\r\n    user: UserReducer,\r\n    version: VersionReducer,\r\n    ...featureReducers,\r\n  };\r\n\r\n  // Reassign the combiner and fromJS functions when\r\n  // stateType is 'immutable' with dynamic imports\r\n  let combiner = combineReducers;\r\n  let fromJS: any = (obj: any) => obj;\r\n  globalThis.STATE_TYPE = stateType;\r\n\r\n  if (stateType === 'immutable') {\r\n    globalThis.immutable = await import(\r\n      /* webpackChunkName: \"immutable\" */ 'immutable'\r\n    );\r\n\r\n    fromJS = (\r\n      await import(/* webpackChunkName: \"from-js\" */ '~/util/fromJSLeaveImmer')\r\n    ).default;\r\n\r\n    combiner = (\r\n      await import(/* webpackChunkName: \"redux-immutable\" */ 'redux-immutable')\r\n    ).combineReducers;\r\n  }\r\n\r\n  const createReducer = (injectedReducers = {}) => {\r\n    const rootReducer = combiner<AppState>({\r\n      ...injectedReducers,\r\n      // other non-injected reducers go here\r\n      ...reducers,\r\n    });\r\n\r\n    return rootReducer;\r\n  };\r\n\r\n  const store = (initialState: AppState) => {\r\n    const runSaga = sagaMiddleware.run;\r\n\r\n    const middleware: StoreEnhancer<\r\n      {\r\n        dispatch: unknown;\r\n      },\r\n      unknown\r\n    > = compose(\r\n      applyMiddleware(\r\n        thunkMiddleware,\r\n        sagaMiddleware,\r\n        routerMiddleware(history)\r\n      ),\r\n      createInjectorsEnhancer({\r\n        createReducer,\r\n        runSaga,\r\n      }),\r\n      reduxDevToolsMiddleware\r\n    );\r\n\r\n    const store: Store<AppState, Action<any>> & {\r\n      runSaga?: typeof runSaga;\r\n      close?: () => void;\r\n    } = createStore<AppState, Action<any>, unknown, unknown>(\r\n      createReducer(),\r\n      initialState,\r\n      middleware\r\n    );\r\n\r\n    store.runSaga = runSaga;\r\n    store.close = () => store.dispatch(END);\r\n\r\n    return store;\r\n  };\r\n\r\n  reduxStore = store(fromJS(initialState));\r\n  return reduxStore;\r\n};\r\n","import { getImmutableOrJS as getIn } from '~/redux/util';\r\n\r\nexport const hasNavigationTree = state =>\r\n  getIn(state, ['navigation', 'isReady']);\r\n\r\nexport const selectNavigationRoot = state =>\r\n  getIn(state, ['navigation', 'root']);\r\n\r\nexport const selectNavigationChildren = state =>\r\n  getIn(state, ['navigation', 'root', 'children']);\r\n\r\nexport const selectNavigationDepends = () => [];\r\n","import { all } from 'redux-saga/effects';\r\nimport { reduxStore as DefaultStore } from './store';\r\n\r\nexport const convertSagaArray = sagas => {\r\n  if (Array.isArray(sagas))\r\n    return function* rootSaga() {\r\n      yield all(sagas);\r\n    };\r\n  return sagas;\r\n};\r\n\r\nexport const injectReducer = ({ key, reducer }, store = DefaultStore) => {\r\n  if (\r\n    Reflect.has(store.injectedReducers, key) &&\r\n    store.injectedReducers[key] === reducer\r\n  )\r\n    return;\r\n  store.injectedReducers[key] = reducer;\r\n\r\n  store.replaceReducer(store.createReducer(store.injectedReducers));\r\n};\r\n\r\nexport const injectSaga = ({ key, saga }, store = DefaultStore) => {\r\n  const rootSaga = convertSagaArray(saga);\r\n  let hasSaga = Reflect.has(store.injectedSagas, key);\r\n\r\n  if (process.env.NODE_ENV !== 'production') {\r\n    const oldDescriptor = store.injectedSagas[key]; // enable hot reloading of daemon and once-till-unmount sagas\r\n\r\n    if (hasSaga && oldDescriptor.saga !== rootSaga) {\r\n      oldDescriptor.task.cancel();\r\n      hasSaga = false;\r\n    }\r\n  }\r\n  console.info('injectSaga, key: ', key, 'hasSaga: ', hasSaga);\r\n\r\n  if (!hasSaga) {\r\n    store.injectedSagas[key] = {\r\n      key,\r\n      saga: rootSaga,\r\n      task: store.runSaga(rootSaga),\r\n    };\r\n  }\r\n};\r\n\r\nexport const injectRedux = ({ key, reducer, saga }, store = DefaultStore) => {\r\n  console.info('injectRedux, key: ', key);\r\n  if (reducer) injectReducer({ key, reducer }, store);\r\n  if (saga) injectSaga({ key, saga }, store);\r\n};\r\n\r\nexport const useInjectRedux = injectRedux;\r\n","import { action } from '../util';\r\nimport { SET_VERSION, SET_VERSION_STATUS } from '../types/version';\r\n\r\nexport const setVersion = (commitRef, buildNo) =>\r\n  action(SET_VERSION, { commitRef, buildNo });\r\n\r\nexport const setVersionStatus = status =>\r\n  action(SET_VERSION_STATUS, { status });\r\n"],"names":["ACTION_PREFIX","GET_NODE_TREE","SET_NODE_TREE","GET_NODE_TREE_ERROR","initialState","root","error","isError","message","isReady","produce","state","action","type","nodes","combineMerge","target","source","options","destination","slice","forEach","item","index","cloneUnlessOtherwiseSpecified","isMergeableObject","merge","indexOf","push","currentHostname","currentPath","currentNode","currentNodeAncestors","currentProject","entryID","entry","undefined","isLoading","location","mappedEntry","notFound","staticRoute","statusCode","SET_ANCESTORS","ancestors","SET_ENTRY","node","defaultStatus","id","Object","keys","length","sys","nodeWithoutEntry","UPDATE_LOADING_STATE","SET_NAVIGATION_PATH","path","entryUri","uri","route","element","window","SET_ROUTE","nextPath","SET_SIBLINGS","currentNodeSiblingParent","siblings","parentId","currentNodeSiblings","currentNodeSiblingsParent","SET_SURROGATE_KEYS","surrogateKeys","split","arrayMerge","SET_TARGET_PROJECT","project","allowedGroups","hostname","VERSION_PREFIX","SET_VERSION","SET_VERSION_STATUS","commitRef","buildNo","contensisVersionStatus","status","routerMiddleware","history","store","next","payload","method","args","reduxStore","featureReducers","stateType","reduxDevToolsMiddleware","f","__REDUX_DEVTOOLS_EXTENSION__","sagaMiddleware","createSagaMiddleware","reducers","navigation","NavigationReducer","routing","RoutingReducer","user","UserReducer","version","VersionReducer","combiner","combineReducers","fromJS","obj","globalThis","STATE_TYPE","immutable","default","createReducer","injectedReducers","rootReducer","runSaga","run","middleware","compose","applyMiddleware","thunkMiddleware","createInjectorsEnhancer","createStore","close","dispatch","END","hasNavigationTree","getIn","selectNavigationRoot","selectNavigationChildren","selectNavigationDepends","convertSagaArray","sagas","Array","isArray","rootSaga","all","injectReducer","key","reducer","DefaultStore","Reflect","has","replaceReducer","injectSaga","saga","hasSaga","injectedSagas","process","env","NODE_ENV","oldDescriptor","task","cancel","console","info","injectRedux","useInjectRedux","setVersion","setVersionStatus"],"mappings":"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"}