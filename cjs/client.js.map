{"version":3,"file":"client.js","sources":["../node_modules/react-dom/client.js","../src/client/client.tsx"],"sourcesContent":["'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","import 'isomorphic-fetch';\nimport React from 'react';\nimport { createRoot, hydrateRoot } from 'react-dom/client';\nimport { Provider as ReduxProvider } from 'react-redux';\nimport { unstable_HistoryRouter as HistoryRouter } from 'react-router-dom';\nimport { loadableReady } from '@loadable/component';\nimport { parse } from 'query-string';\nimport { CookiesProvider } from 'react-cookie';\n\nimport { selectVersionStatus } from '~/redux/selectors/version';\nimport { setVersionStatus } from '~/redux/actions/version';\nimport rootSaga from '~/redux/sagas';\nimport { browserHistory as history } from '~/redux/store/history';\nimport createStore from '~/redux/store/store';\n\nimport { setCurrentProject } from '~/routing/redux/actions';\n\nimport { deliveryApi } from '~/util/ContensisDeliveryApi';\nimport pickProject from '~/util/pickProject';\n\nimport { AppConfig } from '~/config';\n\ndeclare let window: typeof globalThis & {\n  isDynamic;\n  REDUX_DATA;\n};\n\ntype ReactAppProps = { routes: any; withEvents: any };\n\nclass ClientApp {\n  constructor(ReactApp: React.ComponentType<ReactAppProps>, config: AppConfig) {\n    const documentRoot = document.getElementById('root') as HTMLElement;\n\n    const {\n      stateType = 'immutable',\n      routes,\n      withReducers,\n      withSagas,\n      withEvents,\n    } = config;\n\n    const GetClientJSX = store => {\n      const ClientJsx = (\n        <CookiesProvider>\n          <ReduxProvider store={store}>\n            <HistoryRouter history={history as any}>\n              <ReactApp routes={routes} withEvents={withEvents} />\n            </HistoryRouter>\n          </ReduxProvider>\n        </CookiesProvider>\n      );\n      return ClientJsx;\n    };\n\n    const isProduction = !(process.env.NODE_ENV !== 'production');\n\n    /**\n     * Webpack HMR Setup.\n     */\n    const HMRRenderer = Component => {\n      if (isProduction)\n        loadableReady(\n          () => {\n            hydrateRoot(documentRoot, Component);\n          },\n          { namespace: 'modern' }\n        );\n      else createRoot(documentRoot).render(Component);\n    };\n\n    const hmr = store => {\n      // webpack Hot Module Replacement API\n      if (module.hot) {\n        module.hot.accept(ReactApp as unknown as string, () => {\n          // if you are using harmony modules ({modules:false})\n          HMRRenderer(GetClientJSX(store));\n        });\n      }\n    };\n\n    const qs = parse(window.location.search);\n    const versionStatus = deliveryApi.getClientSideVersionStatus();\n\n    if (\n      window.isDynamic ||\n      window.REDUX_DATA ||\n      process.env.NODE_ENV !== 'production'\n    ) {\n      createStore(withReducers, window.REDUX_DATA, history, stateType).then(\n        store => {\n          const state = store.getState();\n          const ssrVersionStatus = selectVersionStatus(state);\n          if (!ssrVersionStatus)\n            store.dispatch(setVersionStatus(versionStatus));\n\n          /* eslint-disable no-console */\n          console.log('Hydrating from inline Redux');\n          /* eslint-enable no-console */\n          store.runSaga(rootSaga(withSagas));\n          store.dispatch(\n            setCurrentProject(\n              pickProject(window.location.hostname, qs),\n              [],\n              window.location.hostname\n            )\n          );\n\n          delete window.REDUX_DATA;\n          HMRRenderer(GetClientJSX(store));\n\n          hmr(store);\n        }\n      );\n    } else {\n      fetch(`${window.location.pathname}?redux=true`)\n        .then(response => response.json())\n        .then(data => {\n          const ssRedux = JSON.parse(data);\n          createStore(withReducers, ssRedux, history, stateType).then(store => {\n            store.dispatch(setVersionStatus(versionStatus));\n\n            store.runSaga(rootSaga(withSagas));\n            store.dispatch(\n              setCurrentProject(\n                pickProject(window.location.hostname, qs),\n                [],\n                window.location.hostname\n              )\n            );\n\n            HMRRenderer(GetClientJSX(store));\n\n            hmr(store);\n          });\n        });\n    }\n  }\n}\n\nexport default ClientApp;\n"],"names":["require$$0","ClientApp","constructor","ReactApp","config","documentRoot","document","getElementById","stateType","routes","withReducers","withSagas","withEvents","GetClientJSX","store","ClientJsx","React","CookiesProvider","ReduxProvider","HistoryRouter","history","isProduction","process","env","NODE_ENV","HMRRenderer","Component","loadableReady","hydrateRoot","namespace","createRoot","render","hmr","module","hot","accept","qs","parse","window","location","search","versionStatus","deliveryApi","getClientSideVersionStatus","isDynamic","REDUX_DATA","createStore","then","state","getState","ssrVersionStatus","selectVersionStatus","dispatch","setVersionStatus","console","log","runSaga","rootSaga","setCurrentProject","pickProject","hostname","fetch","pathname","response","json","data","ssRedux","JSON"],"mappings":"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"}